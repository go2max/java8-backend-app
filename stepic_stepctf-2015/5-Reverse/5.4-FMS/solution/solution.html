Стандартная уявзимость форматной строки. Задача: получить шелл и прочитать flag.txt.


Тыкаемся куда попало, пишем все подряд во все поля, пока не замечаем, что при регистрации логин выводится через printf.

Вводим много-много %p, получаем большой дамп стека. Здесь же видим, что сервис работает на x64.
Я вводил %p-%p-... , вершина стека выглядела как:

0x400f28
0x7f40994a39e0
(nil)
0x746e65727275430a
0x6567676f6c20796c
0x70252d70252d7025 <<== 70252d это те самые %p-
0x252d70252d70252d
0x2d70252d70252d70
...

То есть, буфер, в который была прочитана наша строка лежит на стеке.
Остается угадать адрес нашей строки на стеке и какого-нибудь адреса возврата, записать одно в другое.
