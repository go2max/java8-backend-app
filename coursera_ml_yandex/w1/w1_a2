Данные

В этом задании мы вновь рассмотрим данные о пассажирах Титаника. Будем решать на них задачу классификации, в которой по различным характеристикам пассажиров требуется предсказать, кто из них выжил после крушения корабля.
Реализация в Scikit-Learn

В библиотеке scikit-learn решающие деревья реализованы в классах sklearn.tree.DecisionTreeСlassifier (для классификации) и sklearn.tree.DecisionTreeRegressor (для регрессии). Обучение модели производится с помощью функции fit.

Пример использования:

import numpy as np
from sklearn.tree import DecisionTreeClassifier
X = np.array([[1, 2], [3, 4], [5, 6]])
y = np.array([0, 1, 0])
clf = DecisionTreeClassifier()
clf.fit(X, y)

Инструкция по выполнению
    Загрузите выборку из файла titanic.csv с помощью пакета Pandas.
    data = pandas.read_csv('/root/titanic.csv', index_col='PassengerId')

    Оставьте в выборке четыре признака: класс пассажира (Pclass), цену билета (Fare), возраст пассажира (Age) и его пол (Sex).

    Обратите внимание, что признак Sex имеет строковые значения.
    def convert_sex(sex):
    if sex == 'male':
        return 1
    else:
        return 0


    Выделите целевую переменную — она записана в столбце Survived.
    В данных есть пропущенные значения — например, для некоторых пассажиров неизвестен их возраст. Такие записи при чтении их в pandas принимают значение nan. Найдите все объекты, у которых есть пропущенные признаки, и удалите их из выборки.
    Обучите решающее дерево с параметром random_state=241 и остальными параметрами по умолчанию.
    Вычислите важности признаков и найдите два признака с наибольшей важностью. Их названия будут ответами для данной задачи.
Обратите внимание, что отправляемые файлы не должны содержать пустую строку в конце.


