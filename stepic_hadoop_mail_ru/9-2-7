Расположите в правильном порядке действия Resource Manager при запуске приложения:

Получение запроса от клиента на запуск приложения
Запрос на выделение container для Application Master
Запуск Application Master
Создание container по запросу Application Master
Освобождение ресурсов после завершения приложения